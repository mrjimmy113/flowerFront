<div class="row">
  <div class="col-sm-4"></div>
  <div class="col-sm-4">
    <form #accountForm="ngForm" (ngSubmit)='onSubmit()'>
      <fieldset>
        <legend class="d-flex justify-content-center">New Account</legend>
        <!--Name-->
        <div class="form-group">
          <label>Username</label>
          <div class="input-group mb-3">
            <input type="text" class="form-control" name="username" #username='ngModel' placeholder="Enter Username"
              [(ngModel)]="account.username" required maxlength="30" minlength="4"
              [ngClass]="{'is-invalid': (username.invalid && (username.dirty || username.touched))}"
              (keyup)="checkUsernameAgain()">
            <div class="input-group-append">
              <div *ngIf="haveNotChecked">
                <button class="btn btn-success" (click)="checkUsername(account.username)"
                  [disabled]="username.invalid || !(username.dirty || username.touched)">Check Username</button>
              </div>
              <div *ngIf="!haveNotChecked">
                <div *ngIf="isAccountExisted">
                  <div class="btn btn-danger">Not Available</div>
                </div>
                <div *ngIf="!isAccountExisted">
                  <div class="btn btn-success">Available</div>
                </div>
              </div>
            </div>

          </div>
          <div *ngIf="username.invalid && (username.dirty || username.touched)" class="text-danger">
            <div *ngIf="username.errors.required">
              Username is required.
            </div>
            <div *ngIf="username.errors.maxlength || username.errors.minlength">
              Username length is from 4 to 30
            </div>
          </div>
        </div>
        <!--Password-->
        <div class="form-group">
          <label>Password</label>
          <input type="password" class="form-control" name="password" #password='ngModel' placeholder="Enter password"
            [(ngModel)]="account.password" required maxlength="20" minlength="4"
            [ngClass]="{'is-invalid': (password.invalid && (password.dirty || password.touched))}">
          <div *ngIf="password.invalid && (password.dirty || password.touched)" class="text-danger">
            <div *ngIf="password.errors.required">
              Password is required.
            </div>
            <div *ngIf="password.errors.maxlength || password.errors.minlength">
              Password length is from 4 to 30
            </div>
          </div>
        </div>
        <!--Confirm Password-->
        <div class="form-group">
          <label>Confirm Password</label>
          <input type="password" class="form-control" name="confirm" #confirm='ngModel'
            placeholder="Enter Password again" pattern="{{account.password}}" [(ngModel)]="confirmPassword"
            [ngClass]="{'is-invalid': (confirm.invalid && (confirm.dirty || confirm.touched))}">
          <div *ngIf="confirm.invalid && (confirm.dirty || confirm.touched)" class="text-danger">
            <div *ngIf="confirm.errors.pattern">
              Confirm Password and Password must be the same
            </div>
          </div>
        </div>
        <!--Email-->
        <div class="form-group">
          <label>Email</label>
          <div class="input-group mb-3">
            <input type="text" class="form-control" name="email" #email='ngModel' placeholder="Enter email"
              [(ngModel)]="account.email" required pattern="^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$"
              [ngClass]="{'is-invalid': (email.invalid && (email.dirty || email.touched))}"
              (keyup)="checkEmailAgain()">
            <div class="input-group-append">
              <div *ngIf="haveNotCheckedEmail">
                <button class="btn btn-success" (click)="checkEmail(account.email)"
                  [disabled]="email.invalid || !(email.dirty || email.touched)">Check email</button>
              </div>
              <div *ngIf="!haveNotCheckedEmail">
                <div *ngIf="isEmailExisted">
                  <div class="btn btn-danger">Not Available</div>
                </div>
                <div *ngIf="!isEmailExisted">
                  <div class="btn btn-success">Available</div>
                </div>
              </div>
            </div>

          </div>
          <div *ngIf="email.invalid && (email.dirty || email.touched)" class="text-danger">
              <div *ngIf="email.errors.required">
                Email is required.
              </div>
              <div *ngIf="email.errors.pattern">
                Email is not valid
              </div>
            </div>
        </div>
        <!--Name-->
        <div class="row">
          <!--First Name-->
          <div class="form-group col-sm-6">
            <label>First Name</label>
            <input type="text" class="form-control" name="name" #name='ngModel' placeholder="Enter name"
              [(ngModel)]="account.name" required maxlength="256"
              [ngClass]="{'is-invalid': (name.invalid && (name.dirty || name.touched))}">
            <div *ngIf="name.invalid && (name.dirty || name.touched)" class="text-danger">
              <div *ngIf="name.errors.required">
                First name is required.
              </div>
              <div *ngIf="name.errors.maxlength">
                First name max length is 256
              </div>
            </div>
          </div>
          <!--Last Name-->
          <div class="form-group col-sm-6">
            <label>Last Name</label>
            <input type="text" class="form-control" name="surname" #surname='ngModel' placeholder="Enter surname"
              [(ngModel)]="account.surname" required maxlength="256"
              [ngClass]="{'is-invalid': (surname.invalid && (surname.dirty || surname.touched))}">
            <div *ngIf="surname.invalid && (surname.dirty || surname.touched)" class="text-danger">
              <div *ngIf="surname.errors.required">
                Last Name is required.
              </div>
              <div *ngIf="surname.errors.maxlength">
                Last Name max length is 256
              </div>
            </div>
          </div>
        </div>
        <!--Address-->
        <div class="form-group">
          <label>Address</label>
          <input type="text" class="form-control" name="address" #address='ngModel' placeholder="Enter Address"
            [(ngModel)]="account.address" required maxlength="500"
            [ngClass]="{'is-invalid': (address.invalid && (address.dirty || address.touched))}">
          <div *ngIf="address.invalid && (address.dirty || address.touched)" class="text-danger">
            <div *ngIf="address.errors.required">
              Address is required.
            </div>
            <div *ngIf="address.errors.maxlength">
              Address max length is 500
            </div>
          </div>
        </div>
        <!--Phone Number-->
        <div class="form-group">
          <label>Phone Number</label>
          <input type="text" class="form-control" name="telephone" #telephone='ngModel' placeholder="Enter Phone number"
            [(ngModel)]="account.telephone" required maxlength="15" pattern="[0-9]*"
            [ngClass]="{'is-invalid': (telephone.invalid && (telephone.dirty || telephone.touched))}">
          <div *ngIf="telephone.invalid && (telephone.dirty || telephone.touched)" class="text-danger">
            <div *ngIf="telephone.errors.required">
              Phone Number is required.
            </div>
            <div *ngIf="telephone.errors.maxlength">
              Phone Number max length is 15
            </div>
            <div *ngIf="telephone.errors.pattern">
              Phone Number must be number
            </div>
          </div>
        </div>
        <!--Action Button-->
        <div class="d-flex justify-content-around">
          <button type="submit" class="btn btn-info" [disabled]='!accountForm.form.valid || isAccountExisted'>Sign
            Up</button>
          <button type="reset" class="btn btn-info">Reset</button>
        </div>
      </fieldset>

    </form>
  </div>
  <div class="col-sm-4"></div>
</div>
